#
# MINIX 3 Release Configuration for RISC-V 64-bit
#
# This file defines the release settings for building MINIX 3
# distribution images for the RISC-V 64-bit architecture.
#

# Architecture settings
MACHINE=evbriscv64
MACHINE_ARCH=riscv64
TARGET_ENDIAN=little

# Toolchain
TOOLCHAIN_PREFIX=riscv64-unknown-elf-
CROSS_COMPILE=${TOOLCHAIN_PREFIX}
CC=${CROSS_COMPILE}gcc
CXX=${CROSS_COMPILE}g++
AS=${CROSS_COMPILE}as
LD=${CROSS_COMPILE}ld
AR=${CROSS_COMPILE}ar
RANLIB=${CROSS_COMPILE}ranlib
OBJCOPY=${CROSS_COMPILE}objcopy
OBJDUMP=${CROSS_COMPILE}objdump
STRIP=${CROSS_COMPILE}strip

# Compiler flags
CFLAGS="-march=rv64gc -mabi=lp64d -O2 -Wall"
CXXFLAGS="${CFLAGS}"
LDFLAGS="-march=rv64gc -mabi=lp64d"

# Build directories
DESTDIR=/usr/obj/minix/riscv64
RELEASEDIR=/usr/release/minix/riscv64
TOOLDIR=/usr/tools/riscv64

# Kernel settings
KERNEL_BASE=0x80200000
KERNEL_ENTRY=_start
KERNEL_FORMAT=elf64-littleriscv

# Memory layout
RAM_BASE=0x80000000
RAM_SIZE=0x10000000    # 256MB default

# Device addresses (QEMU virt platform)
UART_BASE=0x10000000
UART_IRQ=10
PLIC_BASE=0x0C000000
CLINT_BASE=0x02000000
VIRTIO_BASE=0x10001000

# Firmware
BIOS=opensbi
OPENSBI_VERSION=1.0

# Image settings
IMAGE_FORMAT=raw
IMAGE_SIZE_MB=256
IMAGE_LABEL="MINIX3_RISCV64"

# Filesystem settings
ROOT_FS=mfs
ROOT_SIZE_MB=64
USR_SIZE_MB=128
HOME_SIZE_MB=32

# Package lists
KERNEL_MODULES=""
BASE_PACKAGES="base comp etc games man misc text"
EXTRA_PACKAGES="x11"

# Features
ENABLE_SMP=yes
ENABLE_FPU=yes
ENABLE_VIRTIO=yes
ENABLE_NETWORKING=yes
ENABLE_X11=no           # X11 not yet ported

# Debug settings
DEBUG_BUILD=no
KERNEL_DEBUG=no
VERBOSE_BUILD=no

# Version info
MINIX_VERSION="3.4.0-riscv64"
RELEASE_DATE=$(date +%Y%m%d)
RELEASE_NAME="MINIX ${MINIX_VERSION}"
